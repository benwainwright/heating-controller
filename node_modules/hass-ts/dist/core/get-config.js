"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getConfig = void 0;
const _utils_1 = require("../utils");
const constants_1 = require("./constants");
const dotenv_1 = __importDefault(require("dotenv"));
/**
 * Get config from execution environment
 *
 * Note, if called as part of a Home Assistant addon, you don't need
 * to explicitly supply any environment variables
 */
const getConfig = () => {
    dotenv_1.default.config();
    const supervisorToken = process.env[constants_1.SUPERVISOR_TOKEN_ENV];
    const path = supervisorToken
        ? `/core/websocket`
        : process.env[constants_1.HASS_PATH_ENV] ?? `/api/websocket`;
    const host = supervisorToken ? `supervisor` : (0, _utils_1.getEnv)(constants_1.HASS_HOST_ENV);
    const port = supervisorToken ? undefined : process.env[constants_1.HASS_PORT_ENV] ?? 8123;
    const token = supervisorToken || (0, _utils_1.getEnv)(constants_1.HASS_TOKEN_ENV);
    return { host, port: port ? Number(port) : undefined, token, path };
};
exports.getConfig = getConfig;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LWNvbmZpZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb3JlL2dldC1jb25maWcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEscUNBQWdDO0FBRWhDLDJDQU1xQjtBQUVyQixvREFBNEI7QUFFNUI7Ozs7O0dBS0c7QUFDSSxNQUFNLFNBQVMsR0FBRyxHQUFlLEVBQUU7SUFDeEMsZ0JBQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNoQixNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLGdDQUFvQixDQUFDLENBQUM7SUFFMUQsTUFBTSxJQUFJLEdBQUcsZUFBZTtRQUMxQixDQUFDLENBQUMsaUJBQWlCO1FBQ25CLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUFhLENBQUMsSUFBSSxnQkFBZ0IsQ0FBQztJQUVuRCxNQUFNLElBQUksR0FBRyxlQUFlLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsSUFBQSxlQUFNLEVBQUMseUJBQWEsQ0FBQyxDQUFDO0lBQ3BFLE1BQU0sSUFBSSxHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUFhLENBQUMsSUFBSSxJQUFJLENBQUM7SUFDOUUsTUFBTSxLQUFLLEdBQUcsZUFBZSxJQUFJLElBQUEsZUFBTSxFQUFDLDBCQUFjLENBQUMsQ0FBQztJQUV4RCxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQztBQUN0RSxDQUFDLENBQUM7QUFiVyxRQUFBLFNBQVMsYUFhcEIifQ==